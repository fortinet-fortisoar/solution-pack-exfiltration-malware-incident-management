| [Home](../README.md) |
|--------------------------------------------|

# Contents

The **Malware Incident Management** solution pack contains following resources.

## Connectors

|Name|Description|
| :- | :- |
|  Active Directory  |  Active Directory (AD) is a directory service that Microsoft developed for Windows domain networks. You can directly query AD to retrieve information about users, groups, and computers, in an organization, by using the Lightweight Directory Access Protocol (LDAP) to directly query the AD.  |
|  Fortinet FortiGate  |  Fortinet FortiGate enterprise firewall provide high performance, consolidated advanced security and granular visibility for broad protection across the entire digital attack surface.  |
|  Fortinet FortiSIEM  |  FortiSIEM provides integrations that allow you to query and make changes to the CMDB, query events, and send incident notifications. Provide actions like get incidents, comment incident, cleared incident, get device details, get monitored organizations, report related actions and get all associated events for an incident from FortiSIEM.  |
|  FortiSOAR SOC Simulator  | The FortiSOAR SOC Simulator connector is a special type of connector that is used to simulate a SOC environment. It creates various scenarios-based artifacts such as alerts, incidents, etc. in FortiSOAR\u2122   |
|  Microsoft WinRM  |  Microsoft WinRM Connector help to connect windows endpoint and execute commands on it.  |



## Module Schema

|Name|Description|
| :- | :- |
|  Event  |  Module contain new fields: Raw Event Log, Reporter IP, Search Keywords, Search Name, Search Reporter IP|

## Global Variable

|Name|Description|
| :- | :- |
|  Action_Icon  |  Action Icon  |
|  Hint_Icon  |  Hint_Icon  |
|  Exclamation_Icon  |  Exclamation_Icon  |
|  Last_Task_Comment_IRI  |  Contain the IRI of last comment added.  |

## Record Set

|Name|Description|
| :- | :- |
|  Malware Incident Management  |  Create the alert of type "Data Exfiltration"  |

## Playbook Collection

|  02 - Use Case - Malware Case Management  |
| :- |

|Playbook Name|Description|
| :- | :- |
|  00 - Create Exfiltration Alert  |  Playbook will create Icon and Alert.  |
|  01 - Get Device Details  |  Enrich device (asset) with CMDB data  |
|  02 - Get Logged On User  |  Identify the user account logged on the device exfiltrating data  |
|  03 - Hunt Exfiltration Process  |  Identify the process exfiltrating data and fetch it from the endpoint device as an indicator  |
|  04 - Fetch and Analyze Exfiltration Process  |  Parses binary file indicator and extract all its artifacts to be rated with CTI  |
|  05 - Escalate Alert To Incident  |  Alert escalation  |
|  06 - Hunt Lateral Movement  |  Uses file indicator's Hashcode to hunt infected devices via malware lateral movement  |
|  07 - Identify and Fetch Delivery Indicators  |  Tracks malware origin and fetches it if it's downloadable via URL  |
|  08 - Malware Incident Remediation  |  Block indicators and infected assets also disable compromised accounts  |
|  Exfiltration Alert Investigation  |  Analysis and triage of exfiltration alert  |
|  > Hunt Exfiltration Process Name  |  Correlating exfiltration public IP with process network activity to get exfiltration process name  |
|  > Escalate Alert to Incident  |  Escalates the alert to T2 (incident) since malicious/suspicious indicators were found  |
|  > Malware Incident Remediation  |  Block infected assets and disable compromised users  |
|  > Hunt Hashcode On All Devices  |  Hunt the existence of a particular file (via its hashcode) on all devices  |
|  > Run SIEM Search Querying and Fetch Dropper File  | Runs FortiSIEM Search based on input keyword, if results matches a file it fetches it and saves it as indicator   |
|  > Download Exfiltration Process  |  Determine the event reporting the exfiltration process for the first time  |
|  > Update Last Task Comment  |  Update the completed comments/tasks once done and set the new comments IRIs on the global var  |
|  > User Indicator AD Enrichment  |  Enrich indicator user with Active Directory data  |
|  > Add Escalation Comment  |  Add escalation comment, if indicator is found Malicious  |
|  > Set Alert Comment Status  |  Set alert comment status to completed  |
|  > Set Incident Comment Status  |  Set incident comment status to completed  |
|  > Extract Indicators from Binary File  |  Parses a binary file and find any indicators within the strings it contains  |
|  > Get Logged On User  |  Get the username associated with a local IP Address automatically. Prompts the analyst if it fails  |
|  > Get Device Details From CMDB  |  Looks up the device details from CMDB and returns the enriched local asset IRI  |

>**Warning:** We recommend that you clone these playbooks before customizing to avoid loss of information while upgrading the solution pack.
