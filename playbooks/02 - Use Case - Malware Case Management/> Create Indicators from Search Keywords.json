{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "> Create Indicators from Search Keywords",
    "aliasName": null,
    "tag": null,
    "description": "Create indicator from the search keyword and link its related events",
    "isActive": true,
    "debug": true,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "incidents_iris",
        "reptDevIpAddr",
        "keywords",
        "parent_record_iri"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/26d51696-4c4a-4f19-aabe-70fa9c9bbf2d",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/aa731e6c-ad80-4e9c-928b-0f79b1c403bc",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Create Indicators",
            "description": null,
            "arguments": {
                "when": "{{vars.indicators | length > 0}}",
                "for_each": {
                    "item": "{{vars.indicators}}",
                    "__bulk": false,
                    "parallel": false,
                    "condition": ""
                },
                "resource": {
                    "tlp": "\/api\/3\/picklists\/7bff95b7-6438-4b01-b23a-0fe8cb5b33d3",
                    "value": "{{vars.item.value}}",
                    "__link": {
                        "events": "{{vars.parent_record_iri}}",
                        "incidents": "{{vars.incidents_iris}}"
                    },
                    "sources": "{{vars.item.type}}",
                    "lastSeen": "{{globalVars.Current_Date}}",
                    "__replace": "true",
                    "accountEnabled": false,
                    "indicatorStatus": "\/api\/3\/picklists\/2f5cff61-fbff-4bb3-96be-302b78a9fb47",
                    "typeofindicator": "{{\"IndicatorType\" | picklist(vars.item.type, \"@id\")}}",
                    "__fieldsToUpdate": [
                        "lastSeen"
                    ],
                    "enrichmentStatus": "\/api\/3\/picklists\/a6d9da29-27b1-4b8a-965d-8d91518540d5"
                },
                "operation": "Append",
                "collection": "\/api\/3\/upsert\/indicators",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "indicators_iris": "{{vars.steps.Create_Indicators|json_query('[][\"@id\"][]')}}"
                }
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "6bd416b7-942e-4978-ad78-4b982ddf2577"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Event IRIs",
            "description": null,
            "arguments": {
                "events_iris": "{{vars.steps.Get_Indicator_Related_Events|json_query('[][][\"@id\"][]')}}"
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "aabd5f3a-d76a-4c26-9750-1737ed6fc6e6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Indicator Related Events",
            "description": null,
            "arguments": {
                "when": "{{vars.steps.Create_Indicators | length > 0}}",
                "for_each": {
                    "item": "{{vars.steps.Create_Indicators}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "indicator": "{{vars.item}}",
                    "reptDevIpAddr": "{{vars.reptDevIpAddr}}"
                },
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "\/api\/3\/workflows\/8fb70603-5112-4d78-987c-325705f6f12d"
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "7a547bec-d8b6-4266-b99f-4a578422e473"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Indicators List",
            "description": null,
            "arguments": {
                "indicators": "{{vars.parsed_keywords.results}}"
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "6a5dc591-e0b2-4992-a358-fa123d18399f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Parse Keywords",
            "description": null,
            "arguments": {
                "parsed_keywords": "{{vars.keywords|extract_artifacts}}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "d997ca60-6cc0-4ac9-ace9-b81fe0189ba6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": []
                    },
                    "keywords": "{{vars.input.params.keywords}}",
                    "reptDevIpAddr": "{{vars.input.params.reptDevIpAddr}}",
                    "useMockOutput": "{{globalVars.Demo_mode}}",
                    "incidents_iris": "{{vars.input.params['incidents_iris']}}",
                    "parent_record_iri": "{{vars.input.params['parent_record_iri']}}"
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "aa731e6c-ad80-4e9c-928b-0f79b1c403bc"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Create Indicators -> Get Indicator Related Events",
            "targetStep": "\/api\/3\/workflow_steps\/7a547bec-d8b6-4266-b99f-4a578422e473",
            "sourceStep": "\/api\/3\/workflow_steps\/6bd416b7-942e-4978-ad78-4b982ddf2577",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "7ceaa8fb-83e3-4f85-9217-61b75c15439c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Indicator Related Events -> Get Event IRIs",
            "targetStep": "\/api\/3\/workflow_steps\/aabd5f3a-d76a-4c26-9750-1737ed6fc6e6",
            "sourceStep": "\/api\/3\/workflow_steps\/7a547bec-d8b6-4266-b99f-4a578422e473",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e9b29a5f-57de-49ef-a2dc-3ea171c2d677"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Indicators List -> Create Indicators",
            "targetStep": "\/api\/3\/workflow_steps\/6bd416b7-942e-4978-ad78-4b982ddf2577",
            "sourceStep": "\/api\/3\/workflow_steps\/6a5dc591-e0b2-4992-a358-fa123d18399f",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "f76cf2aa-9dff-4e13-ba83-3664e4dec705"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Parse Keyword -> Copy of Parse Keyword",
            "targetStep": "\/api\/3\/workflow_steps\/6a5dc591-e0b2-4992-a358-fa123d18399f",
            "sourceStep": "\/api\/3\/workflow_steps\/d997ca60-6cc0-4ac9-ace9-b81fe0189ba6",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "f3aa5918-73e6-4824-a079-e8cc4423fb4a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Parse Keyword",
            "targetStep": "\/api\/3\/workflow_steps\/d997ca60-6cc0-4ac9-ace9-b81fe0189ba6",
            "sourceStep": "\/api\/3\/workflow_steps\/aa731e6c-ad80-4e9c-928b-0f79b1c403bc",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "9ef17049-daae-416e-bcc3-79994b057f52"
        }
    ],
    "groups": [],
    "priority": null,
    "uuid": "95bb5a82-e42f-453c-b4a7-2b047a153985",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Threat Hunting",
        "Indicators"
    ]
}