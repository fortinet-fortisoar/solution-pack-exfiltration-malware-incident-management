{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "> Hunt Hashcode On All Devices",
    "aliasName": null,
    "tag": null,
    "description": "Hunt the existence of a particular file (via its hashcode) on all devices",
    "isActive": true,
    "debug": true,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "hashcode",
        "parent_object_iri",
        "incident_iri",
        "device_ip_address",
        "username",
        "incident_iri"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/26d51696-4c4a-4f19-aabe-70fa9c9bbf2d",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/85e2b84f-9de1-4d1e-81e0-1f70a6eaf03d",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "mockout_data": "{\n  \"data\": {\n    \"@start\": \"0\",\n    \"events\": [\n      {\n        \"id\": \"1351783589699283456\",\n        \"nid\": \"1351783589699283456\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n        \"attributes\": {\n          \"user\": \"NETWORK SERVICE\",\n          \"eventName\": \"A file stream is created\",\n          \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n          \"phRecvTime\": \"{{arrow.now().shift(minutes=-12).format(\"MMM DD YYYY HH:mm:ss\")}}\",\n          \"swProcName\": \"C:\\\\Program Files\\\\Windows NT\\\\PipeInitUVLM.exe\",\n          \"rawEventMsg\": \"{{arrow.now().shift(minutes=-12).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}Z helios-st03.fortielab.com 10.101.3.45 AccelOps-WUA-WinLog-Microsoft-Windows-Sysmon\/Operational [phCustId]=\\\"2000\\\" [customer]=\\\"fortielab\\\" [monitorStatus]=\\\"Success\\\" [Locale]=\\\"en-US\\\" [MachineGuid]=\\\"163ed29b-96e0-44fc-ae2c-cfcf66128bb6\\\" [timeZone]=\\\"0000\\\" [eventName]=\\\"Microsoft-Windows-Sysmon\/Operational\\\" [eventSource]=\\\"Microsoft-Windows-Sysmon\\\" [eventId]=\\\"15\\\" [eventType]=\\\"Information\\\" [domain]=\\\"NT AUTHORITY\\\" [computer]=\\\"helios-st03.fortielab.com\\\" [user]=\\\"SYSTEM\\\" [userSID]=\\\"S-1-5-18\\\" [userSIDAcctType]=\\\"User\\\" [eventTime]=\\\"{{arrow.now().shift(minutes=-12).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [deviceTime]=\\\"{{arrow.now().shift(minutes=-12).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [msg]=\\\"File stream created:\\nUtcTime: {{arrow.now().shift(minutes=-12).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}ProcessGuid: {163ed29b-96e0-44fc-ae2c-cfcf66128bb6}\\nProcessId: 26032\\nImage: SYSTEM\\nTargetFilename: C:\\\\Program Files\\\\Windows NT\\\\PipeInitUVLM.exe\\nCreationUtcTime: {{arrow.now().shift(minutes=-12).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}\\nHash: MD5=0825C513B61B70D0D47B110617DDD6E7,HA256={{vars.hashcode}}\",\n          \"reptDevIpAddr\": \"10.101.3.45\"\n        },\n        \"receiveTime\": \"{{arrow.now().shift(minutes=-12).format(\"YYYY-MM-DDTHH:mm:ssZ\")}}\"\n      },\n            {\n        \"id\": \"1001783580694578292\",\n        \"nid\": \"1001783580694578292\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n        \"attributes\": {\n          \"user\": \"NETWORK SERVICE\",\n          \"eventName\": \"A file stream is created\",\n          \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n          \"phRecvTime\": \"{{arrow.now().shift(minutes=-13).format(\"MMM DD YYYY HH:mm:ss\")}}\",\n          \"swProcName\": \"C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\",\n          \"rawEventMsg\": \"{{arrow.now().shift(minutes=-13).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}Z cosmos-3fr.fortielab.com 10.200.3.28 AccelOps-WUA-WinLog-Microsoft-Windows-Sysmon\/Operational [phCustId]=\\\"2000\\\" [customer]=\\\"fortielab\\\" [monitorStatus]=\\\"Success\\\" [Locale]=\\\"en-US\\\" [MachineGuid]=\\\"163ed29b-96e0-1428-c231-23d34bca6523\\\" [timeZone]=\\\"0000\\\" [eventName]=\\\"Microsoft-Windows-Sysmon\/Operational\\\" [eventSource]=\\\"Microsoft-Windows-Sysmon\\\" [eventId]=\\\"15\\\" [eventType]=\\\"Information\\\" [domain]=\\\"NT AUTHORITY\\\" [computer]=\\\"cosmos-3fr.fortielab.com\\\" [user]=\\\"SYSTEM\\\" [userSID]=\\\"S-1-5-18\\\" [userSIDAcctType]=\\\"User\\\" [eventTime]=\\\"{{arrow.now().shift(minutes=-13).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [deviceTime]=\\\"{{arrow.now().shift(minutes=-13).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [msg]=\\\"File stream created:\\nUtcTime: {{arrow.now().shift(minutes=-13).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}ProcessGuid: {163ed29b-96e0-1428-c231-23d34bca6523}\\nProcessId: 98766\\nImage: SYSTEM\\nTargetFilename: C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\\nCreationUtcTime: {{arrow.now().shift(minutes=-13).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}\\nHash: MD5=0825C513B61B70D0D47B110617DDD6E7,HA256={{vars.hashcode}}\",\n          \"reptDevIpAddr\": \"10.200.3.28\"\n        },\n        \"receiveTime\": \"{{arrow.now().shift(minutes=-13).format(\"YYYY-MM-DDTHH:mm:ssZ\")}}\"\n      },\n      {\n        \"id\": \"1351783589694579854\",\n        \"nid\": \"1351783589694579854\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n        \"attributes\": {\n          \"user\": \"NETWORK SERVICE\",\n          \"eventName\": \"A file stream is created\",\n          \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n          \"phRecvTime\": \"{{arrow.now().shift(minutes=-14).format(\"MMM DD YYYY HH:mm:ss\")}}\",\n          \"swProcName\": \"C:\\\\Program Files\\\\Windows NT\\\\Win32CleanP.exe\",\n          \"rawEventMsg\": \"{{arrow.now().shift(minutes=-14).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}Z 4th-dsk-ulta2.fortielab.com 10.200.1.144 AccelOps-WUA-WinLog-Microsoft-Windows-Sysmon\/Operational [phCustId]=\\\"2000\\\" [customer]=\\\"fortielab\\\" [monitorStatus]=\\\"Success\\\" [Locale]=\\\"en-US\\\" [MachineGuid]=\\\"163ed29b-96e0-1428-c231-23d34bca9872\\\" [timeZone]=\\\"0000\\\" [eventName]=\\\"Microsoft-Windows-Sysmon\/Operational\\\" [eventSource]=\\\"Microsoft-Windows-Sysmon\\\" [eventId]=\\\"15\\\" [eventType]=\\\"Information\\\" [domain]=\\\"NT AUTHORITY\\\" [computer]=\\\"4th-dsk-ulta2.fortielab.com\\\" [user]=\\\"SYSTEM\\\" [userSID]=\\\"S-1-5-18\\\" [userSIDAcctType]=\\\"User\\\" [eventTime]=\\\"{{arrow.now().shift(minutes=-14).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [deviceTime]=\\\"{{arrow.now().shift(minutes=-14).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [msg]=\\\"File stream created:\\nUtcTime: {{arrow.now().shift(minutes=-14).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}ProcessGuid: {163ed29b-96e0-1428-c231-23d34bca9872}\\nProcessId: 36543\\nImage: SYSTEM\\nTargetFilename: C:\\\\Program Files\\\\Windows NT\\\\Win32CleanP.exe\\nCreationUtcTime: {{arrow.now().shift(minutes=-14).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}\\nHash: MD5=0825C513B61B70D0D47B110617DDD6E7,HA256={{vars.hashcode}}\",\n          \"reptDevIpAddr\": \"10.200.1.144\"\n        },\n        \"receiveTime\": \"{{arrow.now().shift(minutes=-14).format(\"YYYY-MM-DDTHH:mm:ssZ\")}}\"\n      },\n      {\n        \"id\": \"1351783589614324567\",\n        \"nid\": \"1351783589614324567\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n        \"attributes\": {\n          \"user\": \"NETWORK SERVICE\",\n          \"eventName\": \"A file stream is created\",\n          \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n          \"phRecvTime\": \"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\",\n          \"swProcName\": \"C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\",\n          \"rawEventMsg\": \"{{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}Z test-bench03.fortielab.com 10.30.33.87 AccelOps-WUA-WinLog-Microsoft-Windows-Sysmon\/Operational [phCustId]=\\\"2000\\\" [customer]=\\\"fortielab\\\" [monitorStatus]=\\\"Success\\\" [Locale]=\\\"en-US\\\" [MachineGuid]=\\\"163ed29b-96e0-1428-c231-23d34bca9872\\\" [timeZone]=\\\"0000\\\" [eventName]=\\\"Microsoft-Windows-Sysmon\/Operational\\\" [eventSource]=\\\"Microsoft-Windows-Sysmon\\\" [eventId]=\\\"15\\\" [eventType]=\\\"Information\\\" [domain]=\\\"NT AUTHORITY\\\" [computer]=\\\"test-bench03.fortielab.com\\\" [user]=\\\"SYSTEM\\\" [userSID]=\\\"S-1-5-18\\\" [userSIDAcctType]=\\\"User\\\" [eventTime]=\\\"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [deviceTime]=\\\"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [msg]=\\\"File stream created:\\nUtcTime: {{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}ProcessGuid: {163ed29b-96e0-1428-c231-23d34bca9872}\\nProcessId: 23933\\nImage: SYSTEM\\nTargetFilename: C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\\nCreationUtcTime: {{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}\\nHash: MD5=0825C513B61B70D0D47B110617DDD6E7,HA256={{vars.hashcode}}\",\n          \"reptDevIpAddr\": \"10.30.33.87\"\n        },\n        \"receiveTime\": \"{{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DDTHH:mm:ssZ\")}}\"\n      },\n      {\n        \"id\": \"1351783589614324567\",\n        \"nid\": \"1351783589614324567\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n        \"attributes\": {\n          \"user\": \"NETWORK SERVICE\",\n          \"eventName\": \"A file stream is created\",\n          \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n          \"phRecvTime\": \"{{arrow.now().shift(minutes=-24).format(\"MMM DD YYYY HH:mm:ss\")}}\",\n          \"swProcName\": \"C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\",\n          \"rawEventMsg\": \"{{arrow.now().shift(minutes=-24).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}Z test-bench03.fortielab.com 10.200.3.17 AccelOps-WUA-WinLog-Microsoft-Windows-Sysmon\/Operational [phCustId]=\\\"2000\\\" [customer]=\\\"fortielab\\\" [monitorStatus]=\\\"Success\\\" [Locale]=\\\"en-US\\\" [MachineGuid]=\\\"163ed29b-96e0-1428-c231-23d34bca9872\\\" [timeZone]=\\\"0000\\\" [eventName]=\\\"Microsoft-Windows-Sysmon\/Operational\\\" [eventSource]=\\\"Microsoft-Windows-Sysmon\\\" [eventId]=\\\"15\\\" [eventType]=\\\"Information\\\" [domain]=\\\"NT AUTHORITY\\\" [computer]=\\\"test-bench03.fortielab.com\\\" [user]=\\\"SYSTEM\\\" [userSID]=\\\"S-1-5-18\\\" [userSIDAcctType]=\\\"User\\\" [eventTime]=\\\"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [deviceTime]=\\\"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [msg]=\\\"File stream created:\\nUtcTime: {{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}ProcessGuid: {163ed29b-96e0-1428-c231-23d34bca9872}\\nProcessId: 23933\\nImage: SYSTEM\\nTargetFilename: C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\\nCreationUtcTime: {{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}\\nHash: MD5=0825C513B61B70D0D47B110617DDD6E7,HA256={{vars.hashcode}}\",\n          \"reptDevIpAddr\": \"10.200.3.17\"\n        },\n        \"receiveTime\": \"{{arrow.now().shift(minutes=-24).format(\"YYYY-MM-DDTHH:mm:ssZ\")}}\"\n      },      \n      {\n        \"id\": \"1351783589614324567\",\n        \"nid\": \"1351783589614324567\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n        \"attributes\": {\n          \"user\": \"NETWORK SERVICE\",\n          \"eventName\": \"A file stream is created\",\n          \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n          \"phRecvTime\": \"{{arrow.now().shift(minutes=-27).format(\"MMM DD YYYY HH:mm:ss\")}}\",\n          \"swProcName\": \"C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\",\n          \"rawEventMsg\": \"{{arrow.now().shift(minutes=-27).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}Z test-bench03.fortielab.com 172.16.11.47 AccelOps-WUA-WinLog-Microsoft-Windows-Sysmon\/Operational [phCustId]=\\\"2000\\\" [customer]=\\\"fortielab\\\" [monitorStatus]=\\\"Success\\\" [Locale]=\\\"en-US\\\" [MachineGuid]=\\\"163ed29b-96e0-1428-c231-23d34bca9872\\\" [timeZone]=\\\"0000\\\" [eventName]=\\\"Microsoft-Windows-Sysmon\/Operational\\\" [eventSource]=\\\"Microsoft-Windows-Sysmon\\\" [eventId]=\\\"15\\\" [eventType]=\\\"Information\\\" [domain]=\\\"NT AUTHORITY\\\" [computer]=\\\"test-bench03.fortielab.com\\\" [user]=\\\"SYSTEM\\\" [userSID]=\\\"S-1-5-18\\\" [userSIDAcctType]=\\\"User\\\" [eventTime]=\\\"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [deviceTime]=\\\"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [msg]=\\\"File stream created:\\nUtcTime: {{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}ProcessGuid: {163ed29b-96e0-1428-c231-23d34bca9872}\\nProcessId: 23933\\nImage: SYSTEM\\nTargetFilename: C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\\nCreationUtcTime: {{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}\\nHash: MD5=0825C513B61B70D0D47B110617DDD6E7,HA256={{vars.hashcode}}\",\n          \"reptDevIpAddr\": \"172.16.11.47\"\n        },\n        \"receiveTime\": \"{{arrow.now().shift(minutes=-27).format(\"YYYY-MM-DDTHH:mm:ssZ\")}}\"\n      },    \n      {\n        \"id\": \"1351783589614324567\",\n        \"nid\": \"1351783589614324567\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n        \"attributes\": {\n          \"user\": \"NETWORK SERVICE\",\n          \"eventName\": \"A file stream is created\",\n          \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n          \"phRecvTime\": \"{{arrow.now().shift(minutes=-33).format(\"MMM DD YYYY HH:mm:ss\")}}\",\n          \"swProcName\": \"C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\",\n          \"rawEventMsg\": \"{{arrow.now().shift(minutes=-33).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}Z test-bench03.fortielab.com 10.200.3.61 AccelOps-WUA-WinLog-Microsoft-Windows-Sysmon\/Operational [phCustId]=\\\"2000\\\" [customer]=\\\"fortielab\\\" [monitorStatus]=\\\"Success\\\" [Locale]=\\\"en-US\\\" [MachineGuid]=\\\"163ed29b-96e0-1428-c231-23d34bca9872\\\" [timeZone]=\\\"0000\\\" [eventName]=\\\"Microsoft-Windows-Sysmon\/Operational\\\" [eventSource]=\\\"Microsoft-Windows-Sysmon\\\" [eventId]=\\\"15\\\" [eventType]=\\\"Information\\\" [domain]=\\\"NT AUTHORITY\\\" [computer]=\\\"test-bench03.fortielab.com\\\" [user]=\\\"SYSTEM\\\" [userSID]=\\\"S-1-5-18\\\" [userSIDAcctType]=\\\"User\\\" [eventTime]=\\\"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [deviceTime]=\\\"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [msg]=\\\"File stream created:\\nUtcTime: {{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}ProcessGuid: {163ed29b-96e0-1428-c231-23d34bca9872}\\nProcessId: 23933\\nImage: SYSTEM\\nTargetFilename: C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\\nCreationUtcTime: {{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}\\nHash: MD5=0825C513B61B70D0D47B110617DDD6E7,HA256={{vars.hashcode}}\",\n          \"reptDevIpAddr\": \"10.200.3.61\"\n        },\n        \"receiveTime\": \"{{arrow.now().shift(minutes=-33).format(\"YYYY-MM-DDTHH:mm:ssZ\")}}\"\n      },   \n      {\n        \"id\": \"1351783589614324567\",\n        \"nid\": \"1351783589614324567\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n        \"attributes\": {\n          \"user\": \"NETWORK SERVICE\",\n          \"eventName\": \"A file stream is created\",\n          \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n          \"phRecvTime\": \"{{arrow.now().shift(minutes=-36).format(\"MMM DD YYYY HH:mm:ss\")}}\",\n          \"swProcName\": \"C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\",\n          \"rawEventMsg\": \"{{arrow.now().shift(minutes=-36).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}Z test-bench03.fortielab.com 172.18.1.12 AccelOps-WUA-WinLog-Microsoft-Windows-Sysmon\/Operational [phCustId]=\\\"2000\\\" [customer]=\\\"fortielab\\\" [monitorStatus]=\\\"Success\\\" [Locale]=\\\"en-US\\\" [MachineGuid]=\\\"163ed29b-96e0-1428-c231-23d34bca9872\\\" [timeZone]=\\\"0000\\\" [eventName]=\\\"Microsoft-Windows-Sysmon\/Operational\\\" [eventSource]=\\\"Microsoft-Windows-Sysmon\\\" [eventId]=\\\"15\\\" [eventType]=\\\"Information\\\" [domain]=\\\"NT AUTHORITY\\\" [computer]=\\\"test-bench03.fortielab.com\\\" [user]=\\\"SYSTEM\\\" [userSID]=\\\"S-1-5-18\\\" [userSIDAcctType]=\\\"User\\\" [eventTime]=\\\"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [deviceTime]=\\\"{{arrow.now().shift(minutes=-18).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [msg]=\\\"File stream created:\\nUtcTime: {{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}ProcessGuid: {163ed29b-96e0-1428-c231-23d34bca9872}\\nProcessId: 23933\\nImage: SYSTEM\\nTargetFilename: C:\\\\Program Files\\\\Windows NT\\\\IRQScheduler.exe\\nCreationUtcTime: {{arrow.now().shift(minutes=-18).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}\\nHash: MD5=0825C513B61B70D0D47B110617DDD6E7,HA256={{vars.hashcode}}\",\n          \"reptDevIpAddr\": \"172.18.1.12\"\n        },\n        \"receiveTime\": \"{{arrow.now().shift(minutes=-36).format(\"YYYY-MM-DDTHH:mm:ssZ\")}}\"\n      },                      \n {\n        \"id\": \"1333783589614324500\",\n        \"nid\": \"1333783589614324500\",\n        \"index\": \"0\",\n        \"custId\": \"1\",\n        \"dataStr\": null,\n        \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n        \"attributes\": {\n          \"user\": \"{{vars.username}}\",\n          \"eventName\": \"A file stream is created\",\n          \"eventType\": \"Win-Sysmon-15-FileCreateStreamHash\",\n          \"phRecvTime\": \"{{arrow.now().shift(minutes=-60).format(\"MMM DD YYYY HH:mm:ss\")}}\",\n          \"swProcName\": \"C:\\\\Program Files\\\\Windows NT\\\\SystemUpdate64.exe\",\n          \"rawEventMsg\": \"{{arrow.now().shift(minutes=-60).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}Z felix.fortielab.com {{vars.device_ip_address}} AccelOps-WUA-WinLog-Microsoft-Windows-Sysmon\/Operational [phCustId]=\\\"2000\\\" [customer]=\\\"fortielab\\\" [monitorStatus]=\\\"Success\\\" [Locale]=\\\"en-US\\\" [MachineGuid]=\\\"81f37bb7-edea-4aeb-8490-ca71483e8490\\\" [timeZone]=\\\"0000\\\" [eventName]=\\\"Microsoft-Windows-Sysmon\/Operational\\\" [eventSource]=\\\"Microsoft-Windows-Sysmon\\\" [eventId]=\\\"15\\\" [eventType]=\\\"Information\\\" [domain]=\\\"NT AUTHORITY\\\" [computer]=\\\"felix.fortielab.com\\\" [user]=\\\"{{vars.username}}\\\" [userSID]=\\\"S-1-5-18\\\" [userSIDAcctType]=\\\"User\\\" [eventTime]=\\\"{{arrow.now().shift(minutes=-60).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [deviceTime]=\\\"{{arrow.now().shift(minutes=-60).format(\"MMM DD YYYY HH:mm:ss\")}}\\\" [msg]=\\\"File stream created:\\nUtcTime: {{arrow.now().shift(minutes=-60).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}ProcessGuid: {81f37bb7-edea-4aeb-8490-ca71483e8490}\\nProcessId: 23423\\nImage:C:\\\\Users\\\\{{vars.username}}\\\\Downloads\\\\Stock_Analysis_Report.docx \\nTargetFilename: C:\\\\Program Files\\\\Windows NT\\\\SystemUpdate64.exe\\nCreationUtcTime: {{arrow.now().shift(minutes=-60).format(\"YYYY-MM-DD HH:mm:ss.SSS\")}}\\nHash: MD5=0825C513B61B70D0D47B110617DDD6E7,HA256={{vars.hashcode}}\",\n          \"reptDevIpAddr\": \"{{vars.device_ip_address}}\"\n        },\n        \"receiveTime\": \"{{arrow.now().shift(minutes=-60).format(\"YYYY-MM-DDTHH:mm:ssZ\")}}\"\n      }              \n      \n    ],\n    \"@queryId\": \"5616515,1665700758764\",\n    \"@errorCode\": \"0\",\n    \"@totalCount\": \"5\"\n  },\n  \"status\": \"Success\",\n  \"message\": \"\",\n  \"operation\": null\n}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "da2a052f-c1c3-4574-af60-642c746f2ae2"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create and Link Events",
            "description": null,
            "arguments": {
                "when": "{{vars.hunt_results.events | length > 0}}",
                "for_each": {
                    "item": "{{vars.hunt_results.events}}",
                    "__bulk": true,
                    "parallel": false,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "name": "{{vars.item.eventType}}",
                    "source": "FortiSIEM",
                    "sourceId": "{{vars.item.id}}",
                    "__replace": "",
                    "eventTime": "{{arrow.get(vars.item.receiveTime).int_timestamp}}",
                    "indicators": "{{vars.parent_record_iri}}",
                    "reporterIP": "{{vars.item.attributes.reptDevIpAddr}}",
                    "searchName": false,
                    "rawEventLog": "{{vars.item.attributes.rawEventMsg}}",
                    "searchReporterIP": false
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/events",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": {
                    "created_events_iris": "{{vars.result}}"
                }
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "1a803cc3-5b12-4d0c-8478-4cedd888618d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Assets",
            "description": null,
            "arguments": {
                "when": "{{vars.assets_ip_list | length > 0}}",
                "for_each": {
                    "item": "{{vars.assets_ip_list}}",
                    "__bulk": true,
                    "parallel": false,
                    "condition": "",
                    "batch_size": 100
                },
                "resource": {
                    "ip": "{{vars.item}}",
                    "hostname": "{{[\"Metis\",\"Adrastea\",\"Amalthea\",\"Thebe\",\"Io\",\"Europa\",\"Ganymede\",\"Callisto\",\"Leda\",\"Himalia\",\"Lysithea\",\"Elara\",\"Ananke\",\"Carme\",\"Pasiphae\",\"Sinope\",\"S_1999_J1\"]|random}}-WS-{{[\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"]|random}}-{{vars.item.split(\".\")[-1]}}",
                    "__replace": "false",
                    "incidents": "{{vars.incident_iri}}",
                    "indicators": "{{vars.parent_record_iri}}",
                    "macAddress": "a2:5e:0b:{{range(10,99)|random}}:{{range(10,99)|random}}:{{range(10,99)|random}}",
                    "propertyOf": "{{[\"IT\",\"TAC\",\"HR\",\"Contractors\",\"Marketing\",\"Finance\"]|random}}",
                    "criticality": "{{\"Criticality\" | picklist(([\"Low\",\"Medium\",\"High\",\"Critical\",\"VeryCritical\"]|random), \"@id\")}}",
                    "dateScanned": "{{arrow.now().shift(minutes=-(range(900,9999)|random)).int_timestamp}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/upsert\/assets",
                "__recommend": [],
                "fieldOperation": {
                    "protocol": "Overwrite",
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "3144c878-b760-4ca9-a656-a4e2898dd08f"
        },
        {
            "@type": "WorkflowStep",
            "name": "_GC_ Assets created and Linked",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "people": [],
                    "content": "<p>{{globalVars.Hint_Icon}} Hunting for hashes returned <span style=\"color: #e67e23;\"><strong>&lt;&lt;{{vars.assets_ip_list |length|string}}&gt;&gt;<\/strong><\/span> matches. The corresponding assets where the files were found are linked to the incident. All assets are located at&nbsp;<span style=\"color: #e67e23;\"><strong>Correlations &gt;&gt; Assets<\/strong>.<\/span><\/p>\n<p>The events resulting of this activity are all under <span><strong style=\"color: #e67e23;\">&nbsp;<\/strong><strong><span style=\"color: #e67e23;\">Indicator &gt;&gt;&nbsp;<span style=\"caret-color: #e67e23;\">Sightings<\/span>&nbsp;&gt;&gt; Events<\/span><\/strong><\/span><\/p>",
                    "__replace": "",
                    "incidents": "{{vars.incident_iri}}",
                    "indicators": "{{vars.parent_record_iri}}",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "840",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "b6e50fb6-3fe1-45a6-b3c2-e7691f6884df"
        },
        {
            "@type": "WorkflowStep",
            "name": "_GC_ Identify Dropper",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "events": "{{vars.created_events_iris|json_query('[][\"@id\"][]')}}",
                    "people": [],
                    "content": "<p>{{globalVars.Action_Icon}} To identify the origin of the malware file :<\/p>\n<ul>\n<li>Open the events tab for the malware file indicator<\/li>\n<li>Sort the events by <span style=\"color: #e67e23;\"><strong>Event Time <\/strong><\/span>field, from the oldest to the newest<\/li>\n<li>Open the oldest event and identify the file\/process dropping the malware<\/li>\n<li>Copy and paste the process name under Search <span style=\"color: #e67e23;\"><strong>Keyword field <\/strong><\/span>so it can be used later to hunt its origin<\/li>\n<li>Within the oldest event, use the <span style=\"color: #e67e23;\"><strong>Execute<\/strong><\/span> button to run playbook: <span style=\"background-color: #e67e23;\"><strong>Search Indicators on SIEM and Get Their Related Events<\/strong><\/span>.<\/li>\n<\/ul>",
                    "__replace": "",
                    "incidents": "{{vars.incident_iri}}",
                    "indicators": "{{vars.parent_record_iri}}",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "975",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "c2ebed57-183c-4784-aaa1-2c06209faa12"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Assets IP List",
            "description": null,
            "arguments": {
                "assets_ip_list": "{{vars.hunt_results.events|json_query('[].attributes.reptDevIpAddr[]')}}"
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "44880436-98a4-4268-abbd-01c8cf867ec8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Hunt Hashcode",
            "description": null,
            "arguments": {
                "name": "Fortinet FortiSIEM",
                "config": "f5c67e3e-14ea-4049-a9ad-eac290afbe43",
                "params": {
                    "cond": "hashSHA256 = \"{{vars.hashcode}}\"",
                    "start": 0,
                    "value": 10,
                    "groupby": "",
                    "orderby": "phRecvTime DESC",
                    "perPage": 1,
                    "AttrList": "phRecvTime,reptDevIpAddr,eventType,eventName,rawEventMsg,swProcName,user",
                    "rel_time": "Hours",
                    "time_selection": "Relative Time"
                },
                "version": "4.5.0",
                "connector": "fortinet-fortisiem",
                "operation": "run_report",
                "mock_result": "{{vars.mockout_data}}",
                "operationTitle": "Run Advanced Search Query",
                "step_variables": {
                    "hunt_results": "{{vars.result.data}}"
                }
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "c9268164-3fdf-4533-8a59-98927ca29b9f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": []
                    },
                    "hashcode": "{{vars.input.params.hashcode}}",
                    "username": "{{vars.input.params.username}}",
                    "incident_iri": "{{vars.input.params['incident_iri']}}",
                    "useMockOutput": "{{globalVars.Demo_mode}}",
                    "device_ip_address": "{{vars.input.params['device_ip_address']}}",
                    "parent_record_iri": "{{vars.input.params['parent_object_iri']}}"
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "85e2b84f-9de1-4d1e-81e0-1f70a6eaf03d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Tack Comments",
            "description": null,
            "arguments": {
                "comments_iris": "{{vars.steps._GC__Identify_Dropper['@id']}}"
            },
            "status": null,
            "top": "1110",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "bde13193-2266-42bf-b80a-1970a543d91d"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Hunt Hashcode",
            "targetStep": "\/api\/3\/workflow_steps\/c9268164-3fdf-4533-8a59-98927ca29b9f",
            "sourceStep": "\/api\/3\/workflow_steps\/da2a052f-c1c3-4574-af60-642c746f2ae2",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "973a5c26-0f10-4d3c-88df-86fef7d255b9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create and Link Events -> Get Assets IP List",
            "targetStep": "\/api\/3\/workflow_steps\/44880436-98a4-4268-abbd-01c8cf867ec8",
            "sourceStep": "\/api\/3\/workflow_steps\/1a803cc3-5b12-4d0c-8478-4cedd888618d",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "ee6ef130-a7d8-44dd-8185-f44d025c4791"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Assets -> _GC_ Assets created and Linked",
            "targetStep": "\/api\/3\/workflow_steps\/b6e50fb6-3fe1-45a6-b3c2-e7691f6884df",
            "sourceStep": "\/api\/3\/workflow_steps\/3144c878-b760-4ca9-a656-a4e2898dd08f",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "4c1f227a-6eec-41dc-b92c-d8ba7e2716d9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "_GC_ Assets created and Linked -> Copy of _GC_ Assets created and Linked",
            "targetStep": "\/api\/3\/workflow_steps\/c2ebed57-183c-4784-aaa1-2c06209faa12",
            "sourceStep": "\/api\/3\/workflow_steps\/b6e50fb6-3fe1-45a6-b3c2-e7691f6884df",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e203a092-db76-4828-8532-0fe6f9163eb3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "_GC_ Identify Dropper -> Tack Comments",
            "targetStep": "\/api\/3\/workflow_steps\/bde13193-2266-42bf-b80a-1970a543d91d",
            "sourceStep": "\/api\/3\/workflow_steps\/c2ebed57-183c-4784-aaa1-2c06209faa12",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "0a2b8ed0-685e-4257-b5fa-899d72f33273"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Assets IP List -> Create Assets",
            "targetStep": "\/api\/3\/workflow_steps\/3144c878-b760-4ca9-a656-a4e2898dd08f",
            "sourceStep": "\/api\/3\/workflow_steps\/44880436-98a4-4268-abbd-01c8cf867ec8",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "219f8b7f-0f4e-4e0b-9ef4-d81b96f0d45b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Hunt Hashcode -> Create and Link Event",
            "targetStep": "\/api\/3\/workflow_steps\/1a803cc3-5b12-4d0c-8478-4cedd888618d",
            "sourceStep": "\/api\/3\/workflow_steps\/c9268164-3fdf-4533-8a59-98927ca29b9f",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "c4f1cba2-5ae9-4554-9362-aabcb9cd4334"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Copy of Get Username",
            "targetStep": "\/api\/3\/workflow_steps\/da2a052f-c1c3-4574-af60-642c746f2ae2",
            "sourceStep": "\/api\/3\/workflow_steps\/85e2b84f-9de1-4d1e-81e0-1f70a6eaf03d",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "a734c0dc-deff-4f07-b346-8ae235d22bfe"
        }
    ],
    "groups": [],
    "priority": null,
    "uuid": "24514f09-202b-4b62-a641-dcf83ffaadba",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Threat Hunting",
        "Indicators"
    ]
}